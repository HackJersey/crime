#NJ Crime
This is a fledgling effort by a small group of New Jersey journalists to scrape, compile and publish monthly crime data in the Garden State.

In the initial phase, we've published Ruby scripts to convert the State Police crime data from PDFs into csvs for each police agency in the state.

Later, we plan to launch a web interface and API serving slices of the crime data. Ultimately, depending on the work it takes for the second phase, we hope to create a dashboard of visualizations for the data as well.

Got a question about the data or how to get involved? [File an issue](https://github.com/HackJersey/crime/issues) or contact one of the [core contributors](https://github.com/HackJersey/crime/blob/master/CONTRIBUTORS.md).

##Get Started
###Set the stage
These scripts use the tabula-extractor Ruby gem, which only runs in the JRuby version of the language. Before you can do anything, you'll have to use a Ruby version manager like rbenv or RVM to install Ruby and then the individual gems we use. If you are a seasoned Rubyist, you can skip to the next section. We'll also assume that you've used git before and have it installed on your command line. (These instructions have been tested on OS X. If you use a Windows machine, please adjust as necessary).

```
git clone git@github.com:HackJersey/crime.git  #clone this repo to your local machine
cd crime
rbenv install jruby-1.7.15  #install this or a newer version of JRuby
rbenv rehash
rbenv local jruby-1.7.15  #set JRuby as your current, local version of Ruby for this project
bundle install  #install the gems that we use and their dependencies
```

###Run the script
Now that you've got the right version of Ruby and the gems installed

Make certain you're in the project directory with the ```csver.rb``` file.
This file takes any number of optional command line arguments for names of the crime report pdfs you want to scrape to CSVs. By default, this is set to ```20150327_crimetrend.pdf```, which was the report for January, 2015 crime stats released in March. To scrape a different report, just list its name after typing ```ruby csver.rb```. So, if I wanted to scrape ```20150327_crimetrend.pdf``` and ```20150327_ucr_2014stats.pdf```, I'd have to type: 

```
ruby csver.rb 20150327_crimetrend.pdf 20150327_ucr_2014stats.pdf
```

Then sit back and wait for the magic to happen.

###But what does it *do*?
This code takes each report you name, splits it into pieces and generates a single CSV for each department (or page) in the original.

It starts by looking for the pdf you name in the ```data/pdfs``` directory. If it's not there, it'll download it from the State Police's website. If it is there, it splits it into separate, single-page PDFs (using the docsplit Ruby gem) and puts them into the ```data/burstpdfs``` directory. For each pdf there, it uses ```tabula-extractor``` to pull out the data table and spit it into a csv. All of the csvs wind up in the aptly named ```data/csvs``` directory.

###Now I see a few hundred csv files. Which one do I want?
Each csv generated by the script follows a consistent naming convention.

YYYY-MM-DD-for-YYYY-MM-ID_NUMBER.csv

The first 10 characters are the date when the State Police posted this PDF report originally. The next 8 characters, starting with "-for-..." is the time period covered by the monthly report. The remaining characters before ".csv" are the unique ID number of the police agency that the stats cover. There is also one file that ends in "-state.csv", which are total numbers for all New Jersey agencies for that time period.

If you're looking for a CSV for a specific department, first find it's ID number in ```lookup-agency.csv```. Beware of agencies with common names. For instance, there are 4 Washington Twp PDs, each in a different county. We'll soon provide a lookup table with more details on each agency, including its home county, to help deal with this. Find your police department and its nine-digit ID number, then look in ```data/csvs``` for any csv that ends with that ID.

##What next?
Right now, these script provide an easier format for dealing with tabular data than the massive, monthly State Police PDFs. In short order, we hope to start ingesting these into a database and provide programmatic access to these numbers, along with historic data. So stay tuned.

##Help us make this better.
This is an early, pre-alpha release. There will be bugs and mistakes in here. Anything you spot that seems odd, please let us know, ideally by [filing an issue](https://github.com/HackJersey/crime/issues) for us. If you have questions or suggestions for features you'd like to see, we want to hear that too. If, for some reason, you don't want to submit an issue, please feel free to also reach out to any of the [core contributors](https://github.com/HackJersey/crime/blob/master/CONTRIBUTORS.md) at any time. With your help, we can make this better and easier to use.
